model User {
  id             String    @id @default(cuid())
  email          String    @unique
  hashedPassword String    @map("hashed_password")
  role           Role      @default(USER)
  totpSecret     String?   @map("totp_secret") // Encrypted TOTP secret for Google Authenticator
  totpEnabled    Boolean   @default(false) @map("totp_enabled")
  sessions       Session[]
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  @@map("users")
}

enum Role {
  SUPER_ADMIN
  ADMIN
  EDITOR
  USER
}